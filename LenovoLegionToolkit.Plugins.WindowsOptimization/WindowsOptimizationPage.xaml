<wpfui:UiPage
    x:Class="LenovoLegionToolkit.WPF.Pages.WindowsOptimizationPage"
    x:Name="PageRoot"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    UseLayoutRounding="True"
    SnapsToDevicePixels="True"
    TextOptions.TextFormattingMode="Display"
    TextOptions.TextRenderingMode="Auto"
    TextOptions.TextHintingMode="Fixed"
    RenderOptions.BitmapScalingMode="HighQuality"
    xmlns:controls="clr-namespace:LenovoLegionToolkit.WPF.Controls"
    xmlns:custom="clr-namespace:LenovoLegionToolkit.WPF.Controls.Custom"
    xmlns:resources="clr-namespace:LenovoLegionToolkit.WPF.Resources"
    xmlns:utils="clr-namespace:LenovoLegionToolkit.WPF.Utils"
    xmlns:wpfui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:conv="clr-namespace:System.Windows.Controls;assembly=PresentationFramework"
    Title="{x:Static resources:Resource.SettingsPage_WindowsOptimization_Title}"
    FlowDirection="{x:Static utils:LocalizationHelper.Direction}"
    Scrollable="False"
    Loaded="Page_Loaded">

    <wpfui:UiPage.Resources>
        <conv:BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <!-- Browser-style Tab RadioButton Style -->
        <Style TargetType="RadioButton" x:Key="NavRadioButtonStyle">
            <Setter Property="Margin" Value="0,0,0,0" />
            <Setter Property="Padding" Value="20,10" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Foreground" Value="{DynamicResource TextFillColorSecondaryBrush}" />
            <Setter Property="Background" Value="{DynamicResource ControlFillColorTertiaryBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
            <Setter Property="BorderThickness" Value="1,1,1,0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border
                            x:Name="RootBorder"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="8,8,0,0"
                            Padding="{TemplateBinding Padding}"
                            Margin="{TemplateBinding Margin}">
                            <ContentPresenter
                                x:Name="ContentPresenter"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                RecognizesAccessKey="True"
                                Content="{TemplateBinding Content}"
                                ContentTemplate="{TemplateBinding ContentTemplate}"
                                TextElement.FontWeight="{TemplateBinding FontWeight}"
                                TextElement.FontSize="{TemplateBinding FontSize}"
                                TextElement.Foreground="{TemplateBinding Foreground}" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="RootBorder" Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                <Setter TargetName="RootBorder" Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
                                <Setter TargetName="RootBorder" Property="BorderThickness" Value="1,1,1,0" />
                                <Setter TargetName="RootBorder" Property="Margin" Value="0,-2,0,0" />
                                <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
                            </Trigger>
                            <Trigger Property="IsChecked" Value="False">
                                <Setter TargetName="RootBorder" Property="Background" Value="{DynamicResource ControlFillColorTertiaryBrush}" />
                                <Setter TargetName="RootBorder" Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
                                <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="{DynamicResource TextFillColorSecondaryBrush}" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="RootBorder" Property="Background" Value="{DynamicResource ControlFillColorSecondaryBrush}" />
                                <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsChecked" Value="True" />
                                    <Condition Property="IsMouseOver" Value="True" />
                                </MultiTrigger.Conditions>
                                <Setter TargetName="RootBorder" Property="Background" Value="{DynamicResource ControlFillColorSecondaryBrush}" />
                            </MultiTrigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="RootBorder" Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                <Setter TargetName="RootBorder" Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
                                <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="{DynamicResource TextFillColorTertiaryBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="Border" x:Key="CardContainerStyle">
            <Setter Property="Padding" Value="20" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Margin" Value="0,0,16,16" />
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{DynamicResource ControlFillColorSecondaryBrush}" />
                        <Setter Property="BorderBrush" Value="{DynamicResource ControlStrokeColorSecondaryBrush}" />
                    </Trigger>
                </Style.Triggers>
        </Style>
        <Style TargetType="TextBlock" x:Key="SectionTitleTextStyle">
            <Setter Property="FontSize" Value="18" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Margin" Value="0,0,0,8" />
            <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
        </Style>
        <Style x:Key="PrimaryActionButtonStyle" TargetType="wpfui:Button" BasedOn="{StaticResource {x:Type wpfui:Button}}">
            <Setter Property="Appearance" Value="Primary" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Background" Value="{DynamicResource AccentFillColorSecondaryBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource AccentFillColorSecondaryBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource TextOnAccentFillColorPrimaryBrush}" />
                <Setter Property="MinWidth" Value="180" />
                <Setter Property="MinHeight" Value="36" />
            <Setter Property="Margin" Value="0,0,12,0" />
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.6" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="CleanupActionButtonStyle" TargetType="wpfui:Button" BasedOn="{StaticResource PrimaryActionButtonStyle}">
            <Setter Property="Visibility" Value="Collapsed" />
            <Setter Property="Margin" Value="0" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                    <Setter Property="Visibility" Value="Visible" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="BeautificationActionButtonStyle" TargetType="wpfui:Button" BasedOn="{StaticResource PrimaryActionButtonStyle}">
            <Setter Property="Visibility" Value="Collapsed" />
            <Setter Property="Margin" Value="0" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsBeautificationMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                    <Setter Property="Visibility" Value="Visible" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </wpfui:UiPage.Resources>

        <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid
            Grid.Row="0"
            Margin="0,0,16,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <StackPanel Margin="0,16,0,24">
                <TextBlock
                    Margin="0,0,0,8"
                    AutomationProperties.Name="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                    Focusable="True"
                    FontSize="24"
                    FontWeight="Medium"
                    Text="{x:Static resources:Resource.SettingsPage_WindowsOptimization_Title}" />

                <TextBlock
                    MaxWidth="540"
                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                    HorizontalAlignment="Left"
                    Text="{x:Static resources:Resource.WindowsOptimizationPage_Info}"
                    TextTrimming="CharacterEllipsis"
                    TextWrapping="Wrap" />
            </StackPanel>

            <wpfui:Button
                Grid.Column="1"
                Margin="32,0,0,0"
                Padding="12"
                VerticalAlignment="Center"
                Background="{DynamicResource ControlFillColorDefaultBrush}"
                BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                BorderThickness="1"
                CornerRadius="12"
                Click="SelectedActionsButton_Click"
                Cursor="Hand">
                <StackPanel>
                    <TextBlock
                        FontSize="14"
                        FontWeight="Medium"
                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                        Text="{x:Static resources:Resource.WindowsOptimizationPage_SelectedActions_Header}" />
                    <TextBlock
                        Margin="0,2,0,0"
                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                        Text="{Binding SelectedActionsSummary, FallbackValue=''}"
                        TextWrapping="Wrap" />
                </StackPanel>
            </wpfui:Button>
        </Grid>

        <Grid Grid.Row="1" Margin="0,0,16,12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" Margin="0,0,0,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="1" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                <Border
                    Grid.Row="0"
                    Grid.Column="0"
                    Background="Transparent"
                    Margin="0,0,24,0">
                    <StackPanel
                        Orientation="Horizontal"
                        VerticalAlignment="Center">
                        <RadioButton
                            x:Name="_optimizationNavButton"
                            Style="{StaticResource NavRadioButtonStyle}"
                            GroupName="OptimizationCleanupBeautificationNav"
                            Content="{x:Static resources:Resource.WindowsOptimizationPage_Tab_Optimization}"
                            IsChecked="True"
                            Checked="OptimizationNavButton_Checked" />
                        <RadioButton
                            x:Name="_cleanupNavButton"
                            Style="{StaticResource NavRadioButtonStyle}"
                            GroupName="OptimizationCleanupBeautificationNav"
                            Content="{x:Static resources:Resource.WindowsOptimizationPage_Tab_Cleanup}"
                            Checked="CleanupNavButton_Checked"
                            Visibility="Collapsed" />
                        <RadioButton
                            x:Name="_driverDownloadNavButton"
                            Style="{StaticResource NavRadioButtonStyle}"
                            GroupName="OptimizationCleanupBeautificationNav"
                            Content="{x:Static resources:Resource.WindowsOptimizationPage_Tab_DriverDownload}"
                            Checked="DriverDownloadNavButton_Checked"
                            Visibility="Collapsed" />
                    </StackPanel>
                </Border>
                
                <Border 
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Height="1"
                    Background="{DynamicResource ControlStrokeColorDefaultBrush}"
                    HorizontalAlignment="Stretch"
                    SnapsToDevicePixels="True" />

                <Grid Grid.Row="0" Grid.Column="1" VerticalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Column="0"
                            VerticalAlignment="Center"
                            Text=""
                            Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                            FontSize="14"
                            Visibility="Collapsed" />

                        <StackPanel
                            Grid.Column="1"
                            HorizontalAlignment="Right">
                            <StackPanel.Resources>
                                <Style TargetType="wpfui:Button" BasedOn="{StaticResource {x:Type wpfui:Button}}">
                                    <Setter Property="MinHeight" Value="36" />
                                </Style>
                            </StackPanel.Resources>
                            <WrapPanel ItemHeight="36" ItemWidth="Auto" Orientation="Horizontal">
                            <wpfui:Button
                                x:Name="_selectRecommendedButton"
                                MinWidth="180"
                                Margin="0,0,12,0"
                                Appearance="Secondary"
                                ToolTip="{x:Static resources:Resource.WindowsOptimizationPage_SelectRecommended_Button}"
                                AutomationProperties.Name="{x:Static resources:Resource.WindowsOptimizationPage_SelectRecommended_Button}"
                                Click="SelectRecommendedButton_Click"
                                Content="{x:Static resources:Resource.WindowsOptimizationPage_SelectRecommended_Button}" />
                            <wpfui:Button
                                x:Name="_clearButton"
                                MinWidth="160"
                                Margin="0,0,12,0"
                                Appearance="Secondary"
                                Click="ClearSelectionButton_Click">
                                <wpfui:Button.Style>
                                    <Style TargetType="wpfui:Button" BasedOn="{StaticResource {x:Type wpfui:Button}}">
                                        <Setter Property="ToolTip" Value="{x:Static resources:Resource.WindowsOptimizationPage_ClearSelection_Button}" />
                                        <Setter Property="AutomationProperties.Name" Value="{x:Static resources:Resource.WindowsOptimizationPage_ClearSelection_Button}" />
                                        <Setter Property="Content" Value="{x:Static resources:Resource.WindowsOptimizationPage_ClearSelection_Button}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsDriverDownloadMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                                <Setter Property="ToolTip" Value="{x:Static resources:Resource.WindowsOptimizationPage_PauseAll_Button}" />
                                                <Setter Property="AutomationProperties.Name" Value="{x:Static resources:Resource.WindowsOptimizationPage_PauseAll_Button}" />
                                                <Setter Property="Content" Value="{x:Static resources:Resource.WindowsOptimizationPage_PauseAll_Button}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </wpfui:Button.Style>
                            </wpfui:Button>
                            </WrapPanel>
                        </StackPanel>
                    </Grid>
            </Grid>

            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Category list for optimization, cleanup, and beautification modes -->
                <ScrollViewer
                    x:Name="_categoriesList"
                    Grid.Column="0"
                    Margin="0,0,16,0"
                    VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Disabled"
                    CanContentScroll="False"
                    PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                    <ScrollViewer.Style>
                        <Style TargetType="ScrollViewer">
                            <Setter Property="Visibility" Value="Visible" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsDriverDownloadMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ScrollViewer.Style>
                    <ItemsControl ItemsSource="{Binding ActiveCategories}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Expander
                                    IsExpanded="{Binding IsExpanded, Mode=TwoWay}"
                                    Margin="0,0,0,8">
                                    <Expander.Header>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0">
                                                <TextBlock
                                                    FontWeight="Medium"
                                                    Text="{Binding Title}" />
                                                <TextBlock
                                                    Margin="0,4,0,0"
                                                    FontSize="12"
                                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                    Text="{Binding Description}"
                                                    TextWrapping="Wrap" />
                                            </StackPanel>
                                            <wpfui:Button
                                                Grid.Column="1"
                                                x:Name="_categorySettingsButton"
                                                Margin="12,0,8,0"
                                                VerticalAlignment="Center"
                                                Appearance="Transparent"
                                                Icon="Settings24"
                                                ToolTip="{x:Static resources:Resource.SystemBeautification_RightClick_OpenStyleSettings}"
                                                Click="OpenStyleSettingsButton_Click"
                                                Visibility="Collapsed">
                                                <wpfui:Button.Style>
                                                    <Style TargetType="wpfui:Button" BasedOn="{StaticResource {x:Type wpfui:Button}}">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Key}" Value="beautify.contextMenu">
                                                                <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                            </Style>
                                                </wpfui:Button.Style>
                                            </wpfui:Button>
                                            <TextBlock
                                                Grid.Column="2"
                                                Margin="0,0,0,0"
                                                VerticalAlignment="Center"
                                                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                Text="{Binding SelectionSummary}" />
                                        </Grid>
                                    </Expander.Header>
                                    <ItemsControl ItemsSource="{Binding Actions}" Margin="12,8,0,0">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,0,0,8" MouseLeftButtonDown="ActionItem_MouseLeftButtonDown">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                                                    <CheckBox
                                                        Grid.Column="0"
                                                        VerticalAlignment="Center"
                                                        IsChecked="{Binding IsSelected, Mode=TwoWay}" />
                                                    <TextBlock
                                                        Grid.Column="1"
                                                        Margin="8,0,0,0"
                                                        VerticalAlignment="Center"
                                                        Text="{Binding Title}" />
                                                    <wpfui:Badge
                                                        Grid.Column="2"
                                                        x:Name="_recommendedBadge"
                                                        Margin="8,0,0,0"
                                                        VerticalAlignment="Center"
                                                        Visibility="{Binding HasRecommendedTag, Converter={StaticResource BoolToVisibilityConverter}}">
                                                        <TextBlock Text="{Binding RecommendedTagText}" />
                                                    </wpfui:Badge>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </Expander>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <!-- Content for driver download mode -->
                <Grid Grid.Column="0" Margin="0,0,16,0">
                    <Grid.Style>
                        <Style TargetType="Grid">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsDriverDownloadMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Grid.Style>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                            <custom:CardControl
                                    Grid.Row="0"
                                Margin="0,0,0,8"
                                FocusVisualStyle="{DynamicResource DefaultControlFocusVisualStyle}">
                                <custom:CardControl.Header>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="3*" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <Label
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            VerticalContentAlignment="Center"
                                            Content="{x:Static resources:Resource.PackagesPage_MachineType}">
                                            <Label.Foreground>
                                                <SolidColorBrush Color="{DynamicResource TextFillColorPrimary}" />
                                            </Label.Foreground>
                                        </Label>
                                        <Label
                                            Grid.Row="1"
                                            Grid.Column="0"
                                            Margin="0,8,0,0"
                                            VerticalContentAlignment="Center"
                                            Content="{x:Static resources:Resource.PackagesPage_OperatingSystem}">
                                            <Label.Foreground>
                                                <SolidColorBrush Color="{DynamicResource TextFillColorPrimary}" />
                                            </Label.Foreground>
                                        </Label>
                                        <Label
                                            Grid.Row="2"
                                            Grid.Column="0"
                                            Margin="0,8,0,0"
                                            VerticalContentAlignment="Center"
                                            Content="{x:Static resources:Resource.PackagesPage_DownloadTo}">
                                            <Label.Foreground>
                                                <SolidColorBrush Color="{DynamicResource TextFillColorPrimary}" />
                                            </Label.Foreground>
                                        </Label>

                                        <wpfui:TextBox
                                            x:Name="_driverMachineTypeTextBox"
                                            Grid.Row="0"
                                            Grid.Column="1"
                                            Margin="8,0,0,0"
                                            AutomationProperties.Name="{x:Static resources:Resource.PackagesPage_MachineType}"
                                            ClearButtonEnabled="False"
                                            PlaceholderText="(eg. 82JQ)" />
                                        <ComboBox
                                            x:Name="_driverOsComboBox"
                                            Grid.Row="1"
                                            Grid.Column="1"
                                            Margin="8,8,0,0"
                                            AutomationProperties.Name="{x:Static resources:Resource.PackagesPage_OperatingSystem}"
                                            MaxDropDownHeight="Auto" />
                                        <Grid
                                            Grid.Row="2"
                                            Grid.Column="1"
                                            Margin="8,8,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>

                                            <wpfui:TextBox
                                                x:Name="_driverDownloadToText"
                                                Grid.Column="0"
                                                AutomationProperties.Name="{x:Static resources:Resource.PackagesPage_DownloadTo}"
                                                ClearButtonEnabled="False"
                                                PlaceholderText="(eg. 82JQ)"
                                                TextChanged="DriverDownloadToText_OnTextChanged" />

                                            <wpfui:Button
                                                Grid.Column="1"
                                                Margin="4,0,0,0"
                                                VerticalAlignment="Stretch"
                                                Click="DriverDownloadToButton_Click"
                                                Icon="MoreHorizontal24"
                                                ToolTip="{x:Static resources:Resource.PackagesPage_DownloadTo}" />

                                            <wpfui:Button
                                                Grid.Column="2"
                                                Margin="4,0,0,-1"
                                                VerticalAlignment="Stretch"
                                                Click="DriverOpenDownloadToButton_Click"
                                                Icon="Open24"
                                                ToolTip="{x:Static resources:Resource.PackagesPage_OpenDownloadTo}" />

                                        </Grid>

                                        <StackPanel
                                            Grid.Row="0"
                                            Grid.RowSpan="3"
                                            Grid.Column="3"
                                            HorizontalAlignment="Right">

                                            <TextBlock
                                                Margin="0,0,0,4"
                                                AutomationProperties.Name="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                                                Focusable="True"
                                                Text="{x:Static resources:Resource.PackagesPage_Source}" />
                                            <RadioButton
                                                x:Name="_driverSourcePrimaryRadio"
                                                AutomationProperties.HelpText="{x:Static resources:Resource.PackagesPage_PrimarySource_Message}"
                                                AutomationProperties.Name="{x:Static resources:Resource.PackagesPage_PrimarySource}"
                                                Focusable="True"
                                                GroupName="driverSource"
                                                    IsChecked="True"
                                                    Checked="DriverSourceRadio_Checked">
                                                <StackPanel>
                                                    <TextBlock Text="{x:Static resources:Resource.PackagesPage_PrimarySource}" />
                                                    <TextBlock
                                                        FontSize="12"
                                                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                        Text="{x:Static resources:Resource.PackagesPage_PrimarySource_Message}" />
                                                </StackPanel>
                                            </RadioButton>
                                            <RadioButton
                                                x:Name="_driverSourceSecondaryRadio"
                                                AutomationProperties.HelpText="{x:Static resources:Resource.PackagesPage_SecondarySource_Message}"
                                                AutomationProperties.Name="{x:Static resources:Resource.PackagesPage_SecondarySource}"
                                                    GroupName="driverSource"
                                                    Checked="DriverSourceRadio_Checked">
                                                <StackPanel>
                                                    <TextBlock Text="{x:Static resources:Resource.PackagesPage_SecondarySource}" />
                                                    <TextBlock
                                                        FontSize="12"
                                                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                        Text="{x:Static resources:Resource.PackagesPage_SecondarySource_Message}" />
                                                </StackPanel>
                                            </RadioButton>

                                        </StackPanel>
                                    </Grid>
                                </custom:CardControl.Header>
                            </custom:CardControl>

                                <Grid x:Name="_driverLoader" Grid.Row="1" Visibility="Visible">
                                    <ScrollViewer
                                        x:Name="_driverScrollViewer"
                                        VerticalScrollBarVisibility="Auto"
                                        HorizontalScrollBarVisibility="Disabled"
                                        CanContentScroll="False"
                                        PreviewMouseWheel="DriverScrollViewer_PreviewMouseWheel">

                                    <StackPanel>

                                        <custom:InfoBar
                                            x:Name="_driverInfoBar"
                                            Title="{x:Static resources:Resource.PackagesPage_Disclaimer_Message}"
                                            Margin="0,0,0,8"
                                            IsClosable="False"
                                            IsOpen="True"
                                            Severity="Informational" />

                                        <Grid Margin="0,0,0,8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="250" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <wpfui:TextBox
                                                x:Name="_driverFilterTextBox"
                                                Grid.Column="0"
                                                AutomationProperties.Name="{x:Static resources:Resource.Filter}"
                                                Icon="Search24"
                                                PlaceholderEnabled="True"
                                                PlaceholderText="{x:Static resources:Resource.Filter}"
                                                TextChanged="DriverFilterTextBox_TextChanged" />
                                            <CheckBox
                                                x:Name="_driverOnlyShowUpdatesCheckBox"
                                                Grid.Column="1"
                                                Margin="16,0,0,0"
                                                Checked="DriverOnlyShowUpdatesCheckBox_OnChecked"
                                                Content="{x:Static resources:Resource.PackagesPage_OnlyShowUpdates}"
                                                Unchecked="DriverOnlyShowUpdatesCheckBox_OnChecked" />
                                            <ComboBox
                                                x:Name="_driverSortingComboBox"
                                                Grid.Column="3"
                                                MaxDropDownHeight="Auto"
                                                SelectedIndex="2"
                                                SelectionChanged="DriverSortingComboBox_SelectionChanged">
                                                <ComboBoxItem Content="{x:Static resources:Resource.PackagesPage_Sort_Name}" />
                                                <ComboBoxItem Content="{x:Static resources:Resource.PackagesPage_Sort_Category}" />
                                                <ComboBoxItem Content="{x:Static resources:Resource.PackagesPage_Sort_Date}" />
                                            </ComboBox>
                                        </Grid>

                                        <!-- Loading indicator -->
                                    <Border
                                            x:Name="_driverLoadingIndicator"
                                            Margin="0,16,0,16"
                                            Padding="20"
                                        Background="{DynamicResource ControlFillColorDefaultBrush}"
                                        BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                                        BorderThickness="1"
                                            CornerRadius="8"
                                            Visibility="Collapsed">
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <wpfui:ProgressRing
                                            Width="20"
                                                    Height="20"
                                            Margin="0,0,12,0"
                                                    IsIndeterminate="True" />
                                        <TextBlock
                                                    VerticalAlignment="Center"
                                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                    Text="{x:Static resources:Resource.WindowsOptimizationPage_ScanningDrivers}" />
                                                </StackPanel>
                                        </Border>

                                        <StackPanel x:Name="_driverPackagesStackPanel" Margin="0,0,0,12" />

                                    </StackPanel>

                                    </ScrollViewer>
                                    </Grid>
                                        </Grid>
                </Grid>
                <ScrollViewer
                    Grid.Column="2"
                    VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Disabled"
                    CanContentScroll="False"
                    PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                    <ScrollViewer.Style>
                        <Style TargetType="ScrollViewer">
                            <Setter Property="MinWidth" Value="0" />
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsDriverDownloadMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                    <Setter Property="MinWidth" Value="260" />
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsBeautificationMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ScrollViewer.Style>
                    <StackPanel>
                        <StackPanel.Resources>
                            <Style x:Key="RightColumnOptimizationCardStyle" TargetType="Border" BasedOn="{StaticResource CardContainerStyle}">
                                <Setter Property="Margin" Value="0,0,0,16" />
                                <Setter Property="Padding" Value="20" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsBeautificationMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                            <Style x:Key="RightColumnCardStyle" TargetType="Border" BasedOn="{StaticResource CardContainerStyle}">
                                <Setter Property="Margin" Value="0,0,0,16" />
                                <Setter Property="Padding" Value="20" />
                                <Setter Property="CornerRadius" Value="8" />
                            </Style>
                            <Style x:Key="RightColumnCleanupCardStyle" TargetType="Border" BasedOn="{StaticResource RightColumnCardStyle}">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                            <Style x:Key="RightColumnExtensionsCardStyle" TargetType="Border" BasedOn="{StaticResource RightColumnCardStyle}">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsExtensionsMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                        <Style x:Key="RightColumnBeautificationCardStyle" TargetType="Border" BasedOn="{StaticResource RightColumnCardStyle}">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsBeautificationMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                        </StackPanel.Resources>
                        
                        <!-- Extensions Mode Content -->
                        <Border
                            Style="{StaticResource RightColumnExtensionsCardStyle}">
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Margin="20">
                                <Viewbox Width="128" Height="128" Margin="0,0,0,24" HorizontalAlignment="Center">
                                    <Path
                                        Data="M12 2L2 7L12 12L22 7L12 2Z M12 14L2 19L12 24L22 19L12 14Z"
                                        Fill="{DynamicResource TextFillColorTertiaryBrush}" />
                                </Viewbox>
                                <TextBlock
                                    FontSize="24"
                                    FontWeight="Medium"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    TextAlignment="Center"
                                    Margin="0,0,0,12"
                                    Text="Extensions" />
                                <TextBlock
                                    FontSize="14"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    TextWrapping="Wrap"
                                    TextAlignment="Center"
                                    MaxWidth="500"
                                    HorizontalAlignment="Center"
                                    Text="Install plugins to extend functionality"
                                    Margin="0,0,0,32"
                                    LineHeight="22" />
                                <custom:CardControl MaxWidth="600" Margin="0,0,0,16">
                                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Margin="20">
                                        <TextBlock
                                            FontSize="18"
                                            FontWeight="Medium"
                                            TextAlignment="Center"
                                            Margin="0,0,0,8"
                                            Text="Coming Soon" />
                                        <TextBlock
                                            FontSize="14"
                                            TextAlignment="Center"
                                            Text="More extensions will be available soon" />
                                    </StackPanel>
                                </custom:CardControl>
                                <TextBlock
                                    FontSize="14"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    TextAlignment="Center"
                                    Text=" tools "
                                    Margin="0,0,0,0" />
                                <TextBlock
                                    FontSize="14"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    TextAlignment="Center"
                                    Text="Tools will appear here once they are available in the tools directory."
                                    Margin="0,4,0,0" />
                            </StackPanel>
                        </Border>
                        
                        <Border
                            Style="{StaticResource RightColumnOptimizationCardStyle}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    FontSize="16"
                                    FontWeight="Medium"
                                    Text="{x:Static resources:Resource.WindowsOptimizationPage_SelectedActions_Header}" />
                                <TextBlock
                                    Grid.Row="1"
                                    Margin="0,2,0,12"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    Text="{Binding SelectedActionsSummary}" />

                                <Grid Grid.Row="2">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <ListView
                                        Grid.Row="0"
                                        ItemsSource="{Binding SelectedOptimizationActions}"
                                        BorderThickness="0"
                                        Background="Transparent"
                                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                        <ListView.ItemContainerStyle>
                                            <Style TargetType="ListViewItem">
                                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                <Setter Property="Margin" Value="0,0,0,8" />
                                                <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                                <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
                                                <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="ListViewItem">
                                                            <Border Background="{TemplateBinding Background}" CornerRadius="8">
                                                                <ContentPresenter Margin="12" />
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                                        <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
                                                    </Trigger>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                                        <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ListView.ItemContainerStyle>
                                        <ListView.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock
                                                        FontWeight="Medium"
                                                        Text="{Binding ActionTitle}"
                                                        TextWrapping="Wrap" />
                                                    <TextBlock
                                                        Margin="0,4,0,0"
                                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                        Text="{Binding CategoryTitle}"
                                                        TextWrapping="Wrap" />
                                                    <TextBlock
                                                        Margin="0,4,0,0"
                                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                        Text="{Binding Description}"
                                                        TextWrapping="Wrap">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="Text" Value="">
                                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>

                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="0,12,0,0"
                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                        Text="{Binding SelectedActionsEmptyText}">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding SelectedOptimizationActions.Count}" Value="0">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Grid>
                            </Grid>
                        </Border>

                        <Border
                            Style="{StaticResource RightColumnCleanupCardStyle}">
                            <StackPanel>
                                <!-- Header section matching left side Expander.Header style -->
                                <TextBlock
                                    FontWeight="Medium"
                                    Margin="0,0,0,2"
                                    Text="{x:Static resources:Resource.WindowsOptimizationPage_CleanupInfo}" />
                                <TextBlock
                                    Margin="0,0,0,12"
                                    FontSize="12"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    Text="{x:Static resources:Resource.WindowsOptimizationPage_CleanupDescription}"
                                    TextWrapping="Wrap" />
                                
                                <!-- Show current running step during cleanup run; otherwise show estimation -->
                                <TextBlock
                                    Margin="0,0,0,4"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    Text="{Binding CurrentOperationText, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}"
                                    TextWrapping="Wrap">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsBusy, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                                <TextBlock
                                    x:Name="_estimatedCleanupText"
                                    Margin="0,0,0,4"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    Text="{Binding EstimatedCleanupSizeText, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}"
                                    TextWrapping="Wrap">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Visible" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsBusy, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                                <Trigger Property="Text" Value="">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                                <TextBlock
                                    Margin="0,0,0,8"
                                    FontSize="12"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    Text="{Binding PendingText, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}"
                                    TextWrapping="Wrap">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding="{Binding Text, ElementName=_estimatedCleanupText}" Value="" />
                                                        <Condition Binding="{Binding IsBusy, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="False" />
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </MultiDataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                                <!-- Current deleting file -->
                                <TextBlock
                                    Margin="0,0,0,12"
                                    FontSize="12"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    Text="{Binding CurrentDeletingFile, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}"
                                    TextWrapping="Wrap"
                                    TextTrimming="CharacterEllipsis">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsBusy, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <Trigger Property="Text" Value="">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                                <!-- Execute Cleanup Button -->
                                <wpfui:Button
                                    x:Name="_runCleanupButton"
                                    MinWidth="180"
                                    Margin="0,0,0,0"
                                    HorizontalAlignment="Stretch"
                                    ToolTip="{Binding RunCleanupButtonText, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}"
                                    AutomationProperties.Name="{Binding RunCleanupButtonText, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}"
                                    Click="RunCleanupButton_Click"
                                    Content="{Binding RunCleanupButtonText, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}">
                                    <wpfui:Button.Style>
                                        <Style TargetType="wpfui:Button" BasedOn="{StaticResource CleanupActionButtonStyle}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </wpfui:Button.Style>
                                </wpfui:Button>
                            </StackPanel>
                        </Border>

                        <Border
                            Style="{StaticResource RightColumnCleanupCardStyle}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <ScrollViewer
                                    Grid.Row="0"
                                    Margin="0,0,0,12"
                                    VerticalScrollBarVisibility="Auto"
                                    HorizontalScrollBarVisibility="Disabled"
                                    PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                                    <StackPanel>
                                        <TextBlock
                                            FontWeight="Medium"
                                            Margin="0,0,0,2"
                                            Text="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Header}" />
                                        <TextBlock
                                            Margin="0,0,0,12"
                                            FontSize="12"
                                            Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                            Text="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Description}"
                                            TextWrapping="Wrap" />
                                        <ItemsControl ItemsSource="{Binding CustomCleanupRules}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.Style>
                                                <Style TargetType="ItemsControl">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding CustomCleanupRules.Count}" Value="0">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ItemsControl.Style>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border
                                                Margin="0,0,0,8"
                                                Padding="12"
                                                Background="{DynamicResource ControlFillColorDefaultBrush}"
                                                CornerRadius="8">
                                                        <StackPanel>
                                                            <TextBlock
                                                                FontWeight="Medium"
                                                                Text="{Binding DirectoryPath}"
                                                                TextWrapping="Wrap" />
                                                            <TextBlock
                                                                Margin="0,4,0,0"
                                                                Text="{Binding ExtensionsDisplay}"
                                                                TextWrapping="Wrap" />
                                                            <TextBlock
                                                                Margin="0,2,0,0"
                                                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                                Text="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Recursive_Label}">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding Recursive}" Value="True">
                                                                                <Setter Property="Visibility" Value="Visible" />
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                                                <wpfui:Button
                                                                    Margin="0,8,8,0"
                                                                    
                                                                    Tag="{Binding}"
                                                                    Click="EditCustomCleanupRuleButton_Click"
                                                                    Content="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Edit}" />
                                                                <wpfui:Button
                                                                    Margin="0,8,0,0"
                                                                    
                                                                    Tag="{Binding}"
                                                                    Click="RemoveCustomCleanupRuleButton_Click"
                                                                    Content="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Remove}" />
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                        <TextBlock
                                            Margin="0,0,0,12"
                                            Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                            Text="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Empty}">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding CustomCleanupRules.Count}" Value="0">
                                                            <Setter Property="Visibility" Value="Visible" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </StackPanel>
                                </ScrollViewer>

                                <StackPanel Grid.Row="1" Orientation="Horizontal">
                                    <wpfui:Button
                                        x:Name="_addCustomCleanupRuleButton"
                                        Margin="0,0,8,0"
                                        Appearance="Secondary"
                                        Click="AddCustomCleanupRuleButton_Click"
                                        Content="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Add}" />
                                    <wpfui:Button
                                        x:Name="_clearCustomCleanupRulesButton"
                                        
                                        Click="ClearCustomCleanupRulesButton_Click"
                                        Content="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Clear}" />
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Windows Beautification Mode Content -->
                        <!-- Theme Settings Section -->
                        <Border
                            Style="{StaticResource RightColumnBeautificationCardStyle}">
                            <StackPanel>
                                <TextBlock
                                    FontWeight="Medium"
                                    FontSize="16"
                                    Text="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Theme_Title}" />
                                <TextBlock
                                    Margin="0,4,0,12"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    FontSize="13"
                                    Text="{x:Static resources:Resource.WindowsOptimizationPage_Beautification_Theme_Description}"
                                    TextWrapping="Wrap" />
                                <StackPanel Margin="0,0,0,0">
                                    <RadioButton
                                        x:Name="_beautificationThemeAutoRadio"
                                        GroupName="BeautificationTheme"
                                        Content="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Theme_Auto}"
                                        Margin="0,0,0,8"
                                        Checked="BeautificationThemeRadio_Checked" />
                                    <RadioButton
                                        x:Name="_beautificationThemeLightRadio"
                                        GroupName="BeautificationTheme"
                                        Content="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Theme_Light}"
                                        Margin="0,0,0,8"
                                        Checked="BeautificationThemeRadio_Checked" />
                                    <RadioButton
                                        x:Name="_beautificationThemeDarkRadio"
                                        GroupName="BeautificationTheme"
                                        Content="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Theme_Dark}"
                                        Margin="0,0,0,8"
                                        Checked="BeautificationThemeRadio_Checked" />
                                    <RadioButton
                                        x:Name="_beautificationThemeClassicRadio"
                                        GroupName="BeautificationTheme"
                                        Content="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Theme_Classic}"
                                        Margin="0,0,0,8"
                                        Checked="BeautificationThemeRadio_Checked" />
                                    <RadioButton
                                        x:Name="_beautificationThemeModernRadio"
                                        GroupName="BeautificationTheme"
                                        Content="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Theme_Modern}"
                                        Margin="0,0,0,0"
                                        Checked="BeautificationThemeRadio_Checked" />
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Transparency Settings Section -->
                        <Border
                            Style="{StaticResource RightColumnBeautificationCardStyle}">
                            <StackPanel>
                                <TextBlock
                                    FontWeight="Medium"
                                    FontSize="16"
                                    Text="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Transparency_Title}" />
                                <TextBlock
                                    Margin="0,4,0,12"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    FontSize="13"
                                    Text="{x:Static resources:Resource.WindowsOptimizationPage_Beautification_Transparency_Description}"
                                    TextWrapping="Wrap" />
                                <wpfui:ToggleSwitch
                                    x:Name="_beautificationTransparencyToggle"
                                    IsChecked="{Binding TransparencyEnabled, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}, Mode=TwoWay}"
                                    Content="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Transparency_Enable}"
                                    Click="TransparencyToggle_Click" />
                            </StackPanel>
                        </Border>

                        <!-- Appearance Settings Section -->
                        <Border
                            Style="{StaticResource RightColumnBeautificationCardStyle}">
                            <StackPanel>
                                <TextBlock
                                    FontWeight="Medium"
                                    FontSize="16"
                                    Text="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Appearance_Title}" />
                                <TextBlock
                                    Margin="0,4,0,12"
                                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                    FontSize="13"
                                    Text="{x:Static resources:Resource.WindowsOptimizationPage_Beautification_Appearance_Description}"
                                    TextWrapping="Wrap" />
                                <StackPanel Margin="0,0,0,0">
                                    <wpfui:ToggleSwitch
                                        x:Name="_beautificationRoundedCornersToggle"
                                        Content="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Appearance_RoundedCorners}"
                                        Margin="0,0,0,8"
                                        IsChecked="{Binding RoundedCornersEnabled, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}, Mode=TwoWay}" />
                                    <wpfui:ToggleSwitch
                                        x:Name="_beautificationShadowsToggle"
                                        Content="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Appearance_Shadows}"
                                        Margin="0,0,0,0"
                                        IsChecked="{Binding ShadowsEnabled, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}, Mode=TwoWay}" />
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Apply Button Section -->
                        <Border
                            Style="{StaticResource RightColumnBeautificationCardStyle}">
                            <StackPanel>
                                <wpfui:Button
                                    x:Name="_applyBeautificationStyleButton"
                                    MinWidth="120"
                                    HorizontalAlignment="Stretch"
                                    Click="ApplyBeautificationStyleButton_Click"
                                    Content="{x:Static resources:Resource.SystemBeautification_MenuStyleSettings_Apply}" />
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Grid>
    </Grid>
</wpfui:UiPage>

