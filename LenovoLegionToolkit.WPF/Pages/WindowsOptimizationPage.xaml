<wpfui:UiPage
    x:Class="LenovoLegionToolkit.WPF.Pages.WindowsOptimizationPage"
    x:Name="PageRoot"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:LenovoLegionToolkit.WPF.Controls"
    xmlns:custom="clr-namespace:LenovoLegionToolkit.WPF.Controls.Custom"
    xmlns:resources="clr-namespace:LenovoLegionToolkit.WPF.Resources"
    xmlns:utils="clr-namespace:LenovoLegionToolkit.WPF.Utils"
    xmlns:wpfui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:conv="clr-namespace:System.Windows.Controls;assembly=PresentationFramework"
    Title="{x:Static resources:Resource.SettingsPage_WindowsOptimization_Title}"
    FlowDirection="{x:Static utils:LocalizationHelper.Direction}"
    Scrollable="False"
    Loaded="Page_Loaded">

    <wpfui:UiPage.Resources>
        <conv:BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <Style TargetType="RadioButton" x:Key="NavRadioButtonStyle">
            <Setter Property="Margin" Value="0,0,12,0" />
            <Setter Property="Padding" Value="16,8" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
            <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border
                            x:Name="RootBorder"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="16">
                            <ContentPresenter
                                x:Name="ContentPresenter"
                                Margin="8,2"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                RecognizesAccessKey="True"
                                Content="{TemplateBinding Content}"
                                ContentTemplate="{TemplateBinding ContentTemplate}"
                                TextElement.FontWeight="{TemplateBinding FontWeight}"
                                TextElement.Foreground="{DynamicResource TextFillColorPrimaryBrush}" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="RootBorder" Property="Background" Value="{DynamicResource AccentFillColorSecondaryBrush}" />
                                <Setter TargetName="RootBorder" Property="BorderBrush" Value="{DynamicResource AccentFillColorSecondaryBrush}" />
                                <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="{DynamicResource TextOnAccentFillColorPrimaryBrush}" />
                            </Trigger>
                            <Trigger Property="IsChecked" Value="False">
                                <Setter TargetName="RootBorder" Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                <Setter TargetName="RootBorder" Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
                                <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="RootBorder" Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                <Setter TargetName="RootBorder" Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
                                <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="{DynamicResource TextFillColorTertiaryBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="Border" x:Key="CardContainerStyle">
            <Setter Property="Padding" Value="20" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource ControlStrokeColorDefaultBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Margin" Value="0,0,16,16" />
        </Style>
        <Style TargetType="TextBlock" x:Key="SectionTitleTextStyle">
            <Setter Property="FontSize" Value="18" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Margin" Value="0,0,0,8" />
            <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
        </Style>
        <Style x:Key="PrimaryActionButtonStyle" TargetType="wpfui:Button" BasedOn="{StaticResource {x:Type wpfui:Button}}">
            <Setter Property="Appearance" Value="Primary" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Background" Value="{DynamicResource AccentFillColorSecondaryBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource AccentFillColorSecondaryBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource TextOnAccentFillColorPrimaryBrush}" />
            <Setter Property="MinWidth" Value="200" />
            <Setter Property="Margin" Value="0,0,12,0" />
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.6" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="ApplyActionButtonStyle" TargetType="wpfui:Button" BasedOn="{StaticResource PrimaryActionButtonStyle}">
            <Setter Property="Visibility" Value="Visible" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                    <Setter Property="Visibility" Value="Collapsed" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="CleanupActionButtonStyle" TargetType="wpfui:Button" BasedOn="{StaticResource PrimaryActionButtonStyle}">
            <Setter Property="Visibility" Value="Collapsed" />
            <Setter Property="Margin" Value="0" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                    <Setter Property="Visibility" Value="Visible" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </wpfui:UiPage.Resources>

        <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid
            Grid.Row="0"
            Margin="0,16,16,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <StackPanel Margin="0,16,0,24">
                <TextBlock
                    Margin="0,0,0,12"
                    AutomationProperties.Name="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                    Focusable="True"
                    FontSize="24"
                    FontWeight="Medium"
                    Text="{x:Static resources:Resource.SettingsPage_WindowsOptimization_Title}" />

                <TextBlock
                    MaxWidth="540"
                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                    HorizontalAlignment="Left"
                    Text="{x:Static resources:Resource.WindowsOptimizationPage_Info}"
                    TextTrimming="CharacterEllipsis"
                    TextWrapping="Wrap" />
            </StackPanel>

            <wpfui:Button
                Grid.Column="1"
                Margin="32,0,0,0"
                Padding="12"
                VerticalAlignment="Center"
                Background="{DynamicResource ControlFillColorDefaultBrush}"
                BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                BorderThickness="1"
                CornerRadius="12"
                Click="SelectedActionsButton_Click"
                Cursor="Hand">
                <StackPanel>
                    <TextBlock
                        FontSize="14"
                        FontWeight="Medium"
                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                        Text="{x:Static resources:Resource.WindowsOptimizationPage_SelectedActions_Header}" />
                    <TextBlock
                        Margin="0,4,0,0"
                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                        Text="{Binding SelectedActionsSummary, FallbackValue=''}"
                        TextWrapping="Wrap" />
                </StackPanel>
            </wpfui:Button>
        </Grid>

        <Grid Grid.Row="1" Margin="0,0,16,12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,24,0">
                        <RadioButton
                            x:Name="_optimizationNavButton"
                            Style="{StaticResource NavRadioButtonStyle}"
                            GroupName="OptimizationCleanupNav"
                            Content="{x:Static resources:Resource.WindowsOptimizationPage_Tab_Optimization}"
                            IsChecked="True"
                            Checked="OptimizationNavButton_Checked" />
                        <RadioButton
                            x:Name="_cleanupNavButton"
                            Style="{StaticResource NavRadioButtonStyle}"
                            GroupName="OptimizationCleanupNav"
                            Content="{x:Static resources:Resource.WindowsOptimizationPage_Tab_Cleanup}"
                            Checked="CleanupNavButton_Checked" />
                    </StackPanel>

                    <Grid Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right">
                        <wpfui:Button
                            x:Name="_applyButton"
                            AutomationProperties.Name="{x:Static resources:Resource.WindowsOptimizationPage_ApplySelected_Button}"
                            Click="ApplyButton_Click"
                            Content="{x:Static resources:Resource.WindowsOptimizationPage_ApplySelected_Button}"
                            Style="{StaticResource ApplyActionButtonStyle}" />
                        <wpfui:Button
                            x:Name="_selectRecommendedButton"
                            MinWidth="200"
                            Margin="0,0,12,0"
                            Appearance="Secondary"
                            AutomationProperties.Name="{x:Static resources:Resource.WindowsOptimizationPage_SelectRecommended_Button}"
                            Click="SelectRecommendedButton_Click"
                            Content="{x:Static resources:Resource.WindowsOptimizationPage_SelectRecommended_Button}" />
                        <wpfui:Button
                            x:Name="_clearButton"
                            MinWidth="180"
                            Margin="0,0,12,0"
                            Appearance="Secondary"
                            AutomationProperties.Name="{x:Static resources:Resource.WindowsOptimizationPage_ClearSelection_Button}"
                            Click="ClearSelectionButton_Click"
                            Content="{x:Static resources:Resource.WindowsOptimizationPage_ClearSelection_Button}" />
                            <wpfui:Button
                                x:Name="_runCleanupButton"
                                MinWidth="200"
                                AutomationProperties.Name="{x:Static resources:Resource.WindowsOptimizationPage_RunCleanup_Button}"
                                Click="RunCleanupButton_Click"
                                Content="{x:Static resources:Resource.WindowsOptimizationPage_RunCleanup_Button}"
                                Style="{StaticResource CleanupActionButtonStyle}" />
                        </StackPanel>
                        <ProgressBar
                            x:Name="_operationProgressBar"
                            Grid.Row="1"
                            Height="4"
                            Margin="0,12,0,0"
                            Minimum="0"
                            Maximum="1"
                            IsIndeterminate="True"
                            Visibility="Collapsed" />
                    </Grid>
            </Grid>

            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition>
                        <ColumnDefinition.Style>
                            <Style TargetType="ColumnDefinition">
                                <Setter Property="Width" Value="0.8*" />
                                <Setter Property="MinWidth" Value="320" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                        <Setter Property="Width" Value="0" />
                                        <Setter Property="MinWidth" Value="0" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ColumnDefinition.Style>
                    </ColumnDefinition>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition>
                        <ColumnDefinition.Style>
                            <Style TargetType="ColumnDefinition">
                                <Setter Property="Width" Value="0" />
                                <Setter Property="MinWidth" Value="0" />
                                <Setter Property="MaxWidth" Value="0" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                        <Setter Property="Width" Value="Auto" />
                                        <Setter Property="MinWidth" Value="280" />
                                        <Setter Property="MaxWidth" Value="400" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ColumnDefinition.Style>
                    </ColumnDefinition>
                </Grid.ColumnDefinitions>

                <Border Grid.Column="0" Margin="0,0,16,0">
                    <Border.Style>
                        <Style TargetType="Border" BasedOn="{StaticResource CardContainerStyle}">
                            <Setter Property="Padding" Value="18" />
                            <Setter Property="Margin" Value="0" />
                            <Setter Property="Visibility" Value="Visible" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <StackPanel>
                        <TextBlock
                            Style="{StaticResource SectionTitleTextStyle}"
                            Text="{x:Static resources:Resource.WindowsOptimizationPage_Tab_Optimization}" />
                        <ListView
                            x:Name="_categoryList"
                            Margin="0,4,0,0"
                            ItemsSource="{Binding ActiveCategories}"
                            SelectedItem="{Binding SelectedCategory, Mode=TwoWay}"
                            BorderThickness="0"
                            Background="Transparent"
                            ScrollViewer.VerticalScrollBarVisibility="Auto"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="Padding" Value="0" />
                                <Setter Property="Margin" Value="0,0,0,12" />
                                <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListViewItem">
                                            <Border x:Name="ItemBorder" Background="{TemplateBinding Background}" BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}" BorderThickness="1" CornerRadius="12">
                                                <ContentPresenter />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="ItemBorder" Property="Background" Value="{DynamicResource ControlFillColorSelectedBrush}" />
                                                    <Setter TargetName="ItemBorder" Property="BorderBrush" Value="{DynamicResource PrimaryBrush}" />
                                                </Trigger>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="ItemBorder" Property="Background" Value="{DynamicResource ControlFillColorHoverBrush}" />
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Margin="12">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <CheckBox
                                            Width="20"
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Center"
                                            IsThreeState="True"
                                            IsChecked="{Binding HeaderCheckState, Mode=TwoWay}" />
                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            FontWeight="Medium"
                                            Text="{Binding Title}"
                                            TextWrapping="Wrap" />
                                        <wpfui:Badge
                                            Grid.Column="2"
                                            Appearance="Secondary"
                                            Background="{DynamicResource ControlFillColorDefaultBrush}"
                                            BorderBrush="{DynamicResource ControlFillColorDefaultBrush}"
                                            Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                            Content="{Binding SelectionSummary}" />
                                    </Grid>
                                    <TextBlock
                                        Margin="0,8,0,0"
                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                        Text="{Binding Description}"
                                        TextWrapping="Wrap" />
                                </StackPanel>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                
                <Border Grid.Column="1" Margin="0,0,16,0">
                    <Border.Style>
                        <Style TargetType="Border" BasedOn="{StaticResource CardContainerStyle}">
                            <Setter Property="Padding" Value="20" />
                        </Style>
                    </Border.Style>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0">
                            <TextBlock
                                Style="{StaticResource SectionTitleTextStyle}"
                                FontSize="20"
                                Text="{Binding SelectedCategory.Title, TargetNullValue=''}"
                                TextWrapping="Wrap" />
                            <TextBlock
                                Margin="0,6,0,12"
                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                Text="{Binding SelectedCategory.Description, TargetNullValue=''}"
                                TextWrapping="Wrap" />
                            <TextBlock
                                Margin="0,0,0,12"
                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                Text="{Binding SelectedCategory.SelectionSummary}">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                                <Setter Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Grid.Style>
                                    <Style TargetType="Grid">
                                        <Setter Property="Visibility" Value="Visible" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Grid.Style>
                                <CheckBox
                                    Grid.Column="0"
                                    Content="{x:Static resources:Resource.WindowsOptimizationPage_SelectAll}"
                                    IsThreeState="True"
                                    IsChecked="{Binding SelectedCategory.HeaderCheckState, Mode=TwoWay}">
                                    <CheckBox.Style>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="Visibility" Value="Visible" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </CheckBox.Style>
                                </CheckBox>
                                <TextBlock
                                    Grid.Column="2"
                                    Margin="12,0,0,0"
                                    VerticalAlignment="Center"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    Text="{Binding SelectedCategory.SelectionSummary}" />
                            </Grid>
                        </StackPanel>

                        <ListView
                            x:Name="_actionList"
                            Grid.Row="1"
                            Margin="0,12,0,0"
                            ItemsSource="{Binding SelectedCategory.Actions}"
                            BorderThickness="0"
                            Background="Transparent"
                            ScrollViewer.VerticalScrollBarVisibility="Visible"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                    <Setter Property="Padding" Value="0" />
                                    <Setter Property="Margin" Value="0,0,0,8" />
                                    <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="ListViewItem">
                                                <Border x:Name="ItemBorder" Background="{TemplateBinding Background}" BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}" BorderThickness="1" CornerRadius="8">
                                                    <ContentPresenter />
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter TargetName="ItemBorder" Property="Background" Value="{DynamicResource ControlFillColorHoverBrush}" />
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding DataContext.IsCleanupMode, RelativeSource={RelativeSource AncestorType=ListView}}" Value="True">
                                            <Setter Property="Margin" Value="0,0,0,4" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Margin="12">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <CheckBox
                                                Grid.Column="0"
                                                IsEnabled="{Binding IsEnabled}"
                                                IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                Content="{Binding Title}" />
                                            <wpfui:Badge
                                                Grid.Column="1"
                                                Margin="12,0,0,0"
                                                Background="{DynamicResource ControlFillColorDefaultBrush}"
                                                BorderBrush="{DynamicResource ControlFillColorDefaultBrush}"
                                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                Content="{Binding RecommendedTagText}"
                                                Visibility="{Binding HasRecommendedTag, Converter={StaticResource BoolToVisibilityConverter}}" />
                                        </Grid>
                                        <TextBlock
                                            Margin="0,6,0,0"
                                            Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                            Text="{Binding Description}"
                                            TextWrapping="Wrap">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                    <Style.Triggers>
                                                        <Trigger Property="Text" Value="">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </StackPanel>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Grid>
                </Border>

                <ScrollViewer
                    Grid.Column="2"
                    VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Disabled"
                    CanContentScroll="False">
                    <ScrollViewer.Style>
                        <Style TargetType="ScrollViewer">
                            <Setter Property="MinWidth" Value="0" />
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                    <Setter Property="MinWidth" Value="260" />
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ScrollViewer.Style>
                    <StackPanel>
                        <StackPanel.Resources>
                            <Style x:Key="RightColumnOptimizationCardStyle" TargetType="Border" BasedOn="{StaticResource CardContainerStyle}">
                                <Setter Property="Margin" Value="0,0,0,16" />
                                <Setter Property="Padding" Value="20" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                            <Style x:Key="RightColumnCardStyle" TargetType="Border" BasedOn="{StaticResource CardContainerStyle}">
                                <Setter Property="Margin" Value="0,0,0,16" />
                                <Setter Property="Padding" Value="20" />
                            </Style>
                            <Style x:Key="RightColumnCleanupCardStyle" TargetType="Border" BasedOn="{StaticResource RightColumnCardStyle}">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsCleanupMode, RelativeSource={RelativeSource AncestorType=wpfui:UiPage}}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </StackPanel.Resources>
                        <Border
                            Style="{StaticResource RightColumnOptimizationCardStyle}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <TextBlock
                                    Grid.Row="0"
                                    FontSize="16"
                                    FontWeight="Medium"
                                    Text="{x:Static resources:Resource.WindowsOptimizationPage_SelectedActions_Header}" />
                                <TextBlock
                                    Grid.Row="1"
                                    Margin="0,4,0,12"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    Text="{Binding SelectedActionsSummary}" />

                                <Grid Grid.Row="2">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <ListView
                                        Grid.Row="0"
                                        ItemsSource="{Binding SelectedOptimizationActions}"
                                        BorderThickness="0"
                                        Background="Transparent"
                                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                        <ListView.ItemContainerStyle>
                                            <Style TargetType="ListViewItem">
                                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                                <Setter Property="Margin" Value="0,0,0,8" />
                                                <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                                <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
                                                <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="ListViewItem">
                                                            <Border Background="{TemplateBinding Background}" CornerRadius="8">
                                                                <ContentPresenter Margin="12" />
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                                        <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
                                                    </Trigger>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter Property="Background" Value="{DynamicResource ControlFillColorDefaultBrush}" />
                                                        <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ListView.ItemContainerStyle>
                                        <ListView.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock
                                                        FontWeight="Medium"
                                                        Text="{Binding ActionTitle}"
                                                        TextWrapping="Wrap" />
                                                    <TextBlock
                                                        Margin="0,4,0,0"
                                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                        Text="{Binding CategoryTitle}"
                                                        TextWrapping="Wrap" />
                                                    <TextBlock
                                                        Margin="0,4,0,0"
                                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                        Text="{Binding Description}"
                                                        TextWrapping="Wrap">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="Text" Value="">
                                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>

                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="0,12,0,0"
                                        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                        Text="{Binding SelectedActionsEmptyText}">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding SelectedOptimizationActions.Count}" Value="0">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Grid>
                            </Grid>
                        </Border>

                        <Border
                            Style="{StaticResource RightColumnCleanupCardStyle}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <ScrollViewer
                                    Grid.Row="0"
                                    Margin="0,0,0,12"
                                    VerticalScrollBarVisibility="Auto"
                                    HorizontalScrollBarVisibility="Disabled">
                                    <StackPanel>
                                        <TextBlock
                                            FontWeight="Medium"
                                            Text="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Header}" />
                                        <TextBlock
                                            Margin="0,4,0,12"
                                            Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                            Text="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Description}"
                                            TextWrapping="Wrap" />
                                        <ItemsControl ItemsSource="{Binding CustomCleanupRules}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.Style>
                                                <Style TargetType="ItemsControl">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding CustomCleanupRules.Count}" Value="0">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ItemsControl.Style>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border
                                                Margin="0,0,0,8"
                                                Padding="12"
                                                Background="{DynamicResource ControlFillColorDefaultBrush}"
                                                CornerRadius="8">
                                                        <StackPanel>
                                                            <TextBlock
                                                                FontWeight="Medium"
                                                                Text="{Binding DirectoryPath}"
                                                                TextWrapping="Wrap" />
                                                            <TextBlock
                                                                Margin="0,4,0,0"
                                                                Text="{Binding ExtensionsDisplay}"
                                                                TextWrapping="Wrap" />
                                                            <TextBlock
                                                                Margin="0,2,0,0"
                                                                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                                                Text="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Recursive_Label}">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding Recursive}" Value="True">
                                                                                <Setter Property="Visibility" Value="Visible" />
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                                                <wpfui:Button
                                                                    Margin="0,8,8,0"
                                                                    
                                                                    Tag="{Binding}"
                                                                    Click="EditCustomCleanupRuleButton_Click"
                                                                    Content="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Edit}" />
                                                                <wpfui:Button
                                                                    Margin="0,8,0,0"
                                                                    
                                                                    Tag="{Binding}"
                                                                    Click="RemoveCustomCleanupRuleButton_Click"
                                                                    Content="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Remove}" />
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                        <TextBlock
                                            Margin="0,0,0,12"
                                            Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                            Text="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Empty}">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding CustomCleanupRules.Count}" Value="0">
                                                            <Setter Property="Visibility" Value="Visible" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </StackPanel>
                                </ScrollViewer>

                                <StackPanel Grid.Row="1" Orientation="Horizontal">
                                    <wpfui:Button
                                        x:Name="_addCustomCleanupRuleButton"
                                        Margin="0,0,8,0"
                                        Appearance="Secondary"
                                        Click="AddCustomCleanupRuleButton_Click"
                                        Content="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Add}" />
                                    <wpfui:Button
                                        x:Name="_clearCustomCleanupRulesButton"
                                        
                                        Click="ClearCustomCleanupRulesButton_Click"
                                        Content="{x:Static resources:Resource.WindowsOptimizationPage_CustomCleanup_Clear}" />
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border
                            Style="{StaticResource RightColumnCleanupCardStyle}">
                            <StackPanel>
                                <TextBlock
                                    FontWeight="Medium"
                                    Text="{x:Static resources:Resource.WindowsOptimizationPage_AppxManagement_Header}" />
                                <TextBlock
                                    Margin="0,4,0,12"
                                    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                    Text="{x:Static resources:Resource.WindowsOptimizationPage_AppxManagement_Description}"
                                    TextWrapping="Wrap" />
                                <ScrollViewer
                                    MaxHeight="220"
                                    VerticalScrollBarVisibility="Auto"
                                    HorizontalScrollBarVisibility="Disabled">
                                    <ItemsControl ItemsSource="{Binding AppxPackages}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <CheckBox
                                                    Margin="0,0,0,8"
                                                    Content="{Binding DisplayName}"
                                                    IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                    ToolTip="{Binding Description}" />
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>

        </Grid>

    </Grid>
</wpfui:UiPage>

